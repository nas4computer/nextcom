<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nextcom CAC Reg Form</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://widget.cloudinary.com/v2.0/global/all.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-slate-100">

<div class="max-w-5xl mx-auto p-6">
<h1 class="text-3xl font-bold text-center mb-6">Nextcom CAC Registration Form</h1>

<form id="cacForm" class="bg-white p-6 rounded-2xl shadow-xl space-y-6">

<input required name="company_name_1" placeholder="Proposed Company Name 1 *" class="input">
<input name="company_name_2" placeholder="Proposed Company Name 2 (optional)" class="input">

<select required name="entity_type" class="input">
<option value="">Select Entity Type *</option>
<option value="Business Name">Business Name – ₦35,000</option>
<option value="Limited Company">Limited Company – ₦35,000</option>
</select>

<button type="button" onclick="addDirector()" class="btn">+ Add Director</button>
<div id="directors"></div>

<div class="border p-4 rounded-xl space-y-2">
<h3 class="font-semibold">Secretary</h3>
<input required name="secretary_first_name" placeholder="First Name *" class="input">
<input name="secretary_middle_name" placeholder="Middle Name" class="input">
<input required name="secretary_surname" placeholder="Surname *" class="input">
<input required type="date" name="secretary_dob" class="input">
<input required name="secretary_email" placeholder="Email *" class="input">
<input required name="secretary_phone" placeholder="Phone *" class="input">
<button type="button" onclick="uploadFile('secretary_id_url')" class="btn">Upload ID *</button>
<input type="hidden" name="secretary_id_url">
<button type="button" onclick="uploadFile('secretary_signature_url')" class="btn">Upload Signature *</button>
<input type="hidden" name="secretary_signature_url">
<button type="button" onclick="uploadFile('secretary_passport_url')" class="btn">Upload Passport *</button>
<input type="hidden" name="secretary_passport_url">
</div>

<button id="submitBtn" type="submit" class="submit">Submit CAC Form</button>
</form>
</div>

<script>
const sheetURL="https://script.google.com/macros/s/AKfycby8TF4lpFKJ6t_ds6ciH9s2R5lR-bnT196sYPhJm0kN8XndPYpAimGi80WniBWlFWmj/exec";
const cloudinaryConfig={cloudName:"danzyjpsh",uploadPreset:"nextcom_unsigned"};
let directorCount=0,uploadsPending=0;

function addDirector(){
 directorCount++;
 const d=document.createElement("div");
 d.className="border p-4 rounded-xl space-y-2 mt-2";
 d.innerHTML=`
 <h3 class="font-semibold">Director ${directorCount}</h3>
 <input required name="director_first_name_${directorCount}" placeholder="First Name *" class="input">
 <input name="director_middle_name_${directorCount}" placeholder="Middle Name" class="input">
 <input required name="director_surname_${directorCount}" placeholder="Surname *" class="input">
 <input required type="number" name="director_shares_${directorCount}" placeholder="Shares Allotted *" class="input">
 <button type="button" onclick="uploadFile('director_id_url_${directorCount}')" class="btn">Upload ID *</button>
 <input type="hidden" name="director_id_url_${directorCount}">
 <button type="button" onclick="uploadFile('director_signature_url_${directorCount}')" class="btn">Upload Signature *</button>
 <input type="hidden" name="director_signature_url_${directorCount}">
 <button type="button" onclick="uploadFile('director_passport_url_${directorCount}')" class="btn">Upload Passport *</button>
 <input type="hidden" name="director_passport_url_${directorCount}">
 `;
 document.getElementById("directors").appendChild(d);
}

function uploadFile(field){
 uploadsPending++;
 cloudinary.openUploadWidget({...cloudinaryConfig,sources:['camera','local']},(e,r)=>{
  if(!e && r.event==="success"){
    document.querySelector(`[name="${field}"]`).value=r.info.secure_url;
    uploadsPending--;
  }
 });
}

document.getElementById("cacForm").addEventListener("submit",async e=>{
 e.preventDefault();
 if(uploadsPending>0){alert("Wait for uploads");return;}
 const data=Object.fromEntries(new FormData(e.target));
 const res=await fetch(sheetURL,{method:"POST",body:JSON.stringify(data)});
 if(await res.text()) alert("Submitted successfully");
});
</script>

<style>
.input{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:10px}
.btn{padding:10px;border:1px dashed #94a3b8;border-radius:10px;width:100%;margin-top:4px}
.submit{background:#2563eb;color:#fff;padding:14px;border-radius:12px;width:100%;font-weight:600;margin-top:12px}
</style>
</body>
</html>
